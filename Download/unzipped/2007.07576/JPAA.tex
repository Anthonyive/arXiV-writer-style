\documentclass[times]{elsarticle}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage[autostyle]{csquotes}
\usepackage[]{geometry} %add [showframe] to show the margins
\geometry{heightrounded}
\usepackage{microtype}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[normalem]{ulem} %for double-underlining
%\usepackage{amsthm}
%\usepackage{mathrsfs}
\usepackage{mathtools} %Necessary for the newfaktor macro for decent categories over categories notation.
\usepackage[shortlabels]{enumitem}
\usepackage{tikz}
\usetikzlibrary{cd,arrows,graphs,petri,snakes,calc}
\usepackage[colorlinks=true,urlcolor=blue,linkcolor=blue,citecolor=red]{hyperref}
\usepackage{rotating}
\usepackage{graphicx}
\usepackage{ifthen}
\usepackage{proof}
\usepackage{subdepth} % To have subscripts of primed variables at the same level
%\usepackage{bm} %for bold fonts
\usepackage{xparse} %Necessary for the newfaktor macro for decent categories over categories notation.
%\usepackage{lineno}
%\linenumbers

\usepackage{JPAAsettings}

%\bibliographystyle{elsarticle-num}
%\bibliographystyle{elsarticle-num-names}

\bibliographystyle{abbrvnat}




\begin{document}
	
	
	
	\begin{frontmatter}
	\title{A Calculus of Substitution for Dinatural Transformations. I.\tnoteref{t1}}
	\tnotetext[t1]{With apologies and gratitude to Kelly~\cite{kelly_many-variable_1972}}
	
	\author{Guy McCusker}
	\ead{G.A.McCusker@bath.ac.uk}
	
	\author{Alessio Santamaria\corref{cor1}\fnref{fn1}}
	\ead{alessio.santamaria@di.unipi.it}
	
	\cortext[cor1]{Corresponding author}
    
    \fntext[fn1]{Present address: Dipartimento di Informatica, Universit√† degli Studi di Pisa, Largo B.\ Pontecorvo 3, 56127 Pisa, Italy}
	
	\address{Department of Computer Science, University of Bath, BA2 7AY Bath, United Kingdom}
	
	\begin{abstract}
%Dinatural transformations, which have been used to interpret the second-order $\lambda$-calculus as well as derivations in intuitionistic logic and multiplicative linear logic, fail to compose in general; this has been known since they were discovered by Dubuc and Street in 1970. Many ad hoc solutions to this remarkable shortcoming have been found, but a general theory of compositionality was missing. In this thesis we show how acyclicity of certain graphs associated to these transformations is a sufficient and essentially necessary condition that ensures that the composite of two arbitrary dinatural transformations is in turn dinatural. This leads (not straightforwardly) to the definition of a generalised functor category, whose objects are functors of mixed variance in many variables, and whose morphisms are transformations that happen to be dinatural only in some of their variables.

Dinatural transformations, which generalise the ubiquitous natural transformations to the case where the domain and codomain functors are of mixed variance, fail to compose in general; this has been known since they were discovered by Dubuc and Street in 1970. Many ad hoc solutions to this remarkable shortcoming have been found, but a general theory of compositionality was missing until Petri\'c, in 2003, introduced the concept of g-dinatural transformations, that is, dinatural transformations together with an appropriate graph: he showed how acyclicity of the composite graph of two arbitrary dinatural transformations is a sufficient and essentially necessary condition for the composite transformation to be in turn dinatural. Here we propose an alternative, semantic rather than syntactic, proof of Petri\'c's theorem, which the authors independently rediscovered with no knowledge of its prior existence; we then use it to define a generalised functor category, whose objects are functors of mixed variance in many variables, and whose morphisms are transformations that happen to be dinatural only in some of their variables.

We also define a notion of horizontal composition for dinatural transformations, extending the well-known version for natural transformations, and prove it is associative and unitary. Horizontal composition embodies substitution of functors into transformations and vice-versa, and is intuitively reflected from the string-diagram point of view by substitution of graphs into graphs.

This work represents the first, fundamental steps towards a substitution calculus for dinatural transformations as sought originally by Kelly, with the intention then to apply it to describe coherence problems abstractly. There are still fundamental difficulties that are yet to be overcome in order to achieve such a calculus, and these will be the subject of future work; however, our contribution places us well in track on the path traced by Kelly towards a calculus of substitution for dinatural transformations.
	\end{abstract}

\begin{keyword}
    Dinatural transformation \sep compositionality \sep substitution \sep coherence \sep Petri Net 
    \MSC[2010] 18A05 \sep 18A23 \sep 18A25 \sep 18A30 \sep 18A32 \sep 18A40 \sep 18C10 \sep 18D05 \sep 18D15
\end{keyword}
	
	\end{frontmatter}

\input{introduction}
\input{vertical}
\input{horizontal}
\input{partialDinatural}
\input{coda}
\input{acknowledgements}









 

\bibliography{JPAAbiblio}

\end{document}

introduction: brief history of dinatural transformations and the compositionality problem. Hint to Kelly's project and his idea of natural transformations with a graph.