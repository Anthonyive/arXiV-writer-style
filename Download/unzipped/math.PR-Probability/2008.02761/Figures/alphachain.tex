\begin{tikzpicture}[%
    node distance = 0.8cm,
        table/.style={circle, draw, minimum width=1cm},
        bp/.style={circle, draw, fill=oxfordblue, inner sep=0pt, minimum width=4pt},
        comment/.style={color=red},
        label/.style={text=oxfordblue},
        line/.style={-, line width = 2pt, color = oxfordblue},
        scale=0.7
    ]
        %Spine
          \node (0) at (2,0) {\verb|Root|};
          \node (1) at (8,0) {$i$};
          \node [bp] (sub1) at (6.5,0) {};
          \node [bp] (sub2) at (3.9,0) {};
          \draw[-, dotted, line width = 2pt] (0) to (sub2);
          \draw[-, line width = 2pt] (sub2) to (sub1) to (1);

        %1st subtree
          \node (1tree_top) at (6.5,4) {$n$};
          \node [bp] (1tree_1bp) at (6.5,1.5) {};
          \node [bp] (1tree_2bp) at (6.5,3) {};
          \node [bp] (1tree_1bp_bp) at (7.25,2) {};
          \node (1tree_1bp_1) at (7.5,3) {};
          \node [text = red] (1tree_1bp_2) at (8,2.4) {$a$};
          \node (1tree_mirror) at (5,2.4) {};
          \node (1tree_2bp_tree) at (5,3) {};
          \node (1tree_top_top) at (6.5,5) {};

          \draw[-, line width = 2pt] (sub1) to (1tree_1bp) to (1tree_2bp) to (1tree_top);
          \draw[-, line width = 2pt] (1tree_1bp) to (1tree_1bp_bp) to (1tree_1bp_2);
          \draw[-, line width = 2pt, oxfordblue] (1tree_1bp_bp.center) [bend right] to (1tree_1bp_1.north) [bend right] to (1tree_1bp_bp.center);
          \draw[-, line width = 2pt, oxfordblue] (1tree_2bp.center) [bend left] to (1tree_2bp_tree.center) [bend left] to (1tree_2bp.center);
          \draw[-, dotted, line width = 2pt, red] (sub1) [bend left] to (1tree_mirror.west) [bend left] to (1tree_top_top.center) [bend left] to (1tree_1bp_2.east) [bend left] to (sub1);

        %2nd subtree
          \node [bp] (2tree_bp) at (3.9,1) {}; 
          \node (2tree_1) at (3.4,2) {}; 
          \node [text = red] (2tree_2) at (4.4,2) {$b$}; 
          \node (2tree_top) at (3.9,3) {};

          \draw[-, line width = 2pt] (sub2) to (2tree_bp) to (2tree_2);
          \draw[-, line width = 2pt, oxfordblue] (2tree_bp.center) [bend left] to (2tree_1.north) [bend left] to (2tree_bp.center);
          \draw[-, dotted, line width = 2pt, red] (sub2) [bend left] to (2tree_1.west) [bend left] to (2tree_top.center) [bend left] to (2tree_2.east) [bend left] to (sub2);

        \begin{scope}[shift={(10,0)}]
        %Spine
          \node (1_0) at (2,0) {\verb|Root|};
          \node [red] (1_1) at (8,0) {$\tildei$};
          \node [bp, red] (1_sub1) at (6.5,0) {};
          \node [bp] (1_sub2) at (3.9,0) {};
          \draw[-, dotted, line width = 2pt] (1_0) to (1_sub2);
          \draw[-, line width = 2pt, red] (1_sub2) to (1_sub1) to (1_1);

        %1st subtree
          \node (1_1tree_top) at (6.5,4) {$n$};
          \node [bp] (1_1tree_1bp) at (6.5,1.5) {};
          \node [bp] (1_1tree_2bp) at (6.5,3) {};
          \node [bp] (1_1tree_1bp_bp) at (7.25,2) {};
          \node (1_1tree_1bp_1) at (7.5,3) {};
          \node [text = red] (1_1tree_1bp_2) at (8,2.4) {$i$};
          \node (1_1tree_2bp_tree) at (5,3) {};

          \draw[-, line width = 2pt] (1_sub1) to (1_1tree_1bp) to (1_1tree_2bp) to (1_1tree_top);
          \draw[-, line width = 2pt] (1_1tree_1bp) to (1_1tree_1bp_bp) to (1_1tree_1bp_2);
          \draw[-, line width = 2pt, oxfordblue] (1_1tree_1bp_bp.center) [bend right] to (1_1tree_1bp_1.north) [bend right] to (1_1tree_1bp_bp.center);
          \draw[-, line width = 2pt, oxfordblue] (1_1tree_2bp.center) [bend left] to (1_1tree_2bp_tree.center) [bend left] to (1_1tree_2bp.center);

        %2nd subtree
          \node [bp] (1_2tree_bp) at (3.9,1) {}; 
          \node (1_2tree_1) at (3.4,2) {}; 
          \node (1_2tree_2) at (4.4,2) {$b$}; 

          \draw[-, line width = 2pt] (1_sub2) to (1_2tree_bp) to (1_2tree_2);
          \draw[-, line width = 2pt, oxfordblue] (1_2tree_bp.center) [bend left] to (1_2tree_1.north) [bend left] to (1_2tree_bp.center);

        \end{scope}
        
        \begin{scope}[shift={(5,-4)}]
        %Spine
          \node (2_0) at (2,0) {\verb|Root|};
          \node [red] (2_1) at (8,0) {$i$};
          \node [bp] (2_sub1) at (7,0) {};
          \node [bp] (2_sub_new) at (5.5,0) {};
          \node [bp] (2_sub2) at (3.9,0) {};
          \draw[-, dotted, line width = 2pt] (2_0) to (2_sub2);
          \draw[-, line width = 2pt] (2_sub2) to (2_sub1) to (2_1);

        %1st subtree
          \node [bp] (2_1tree_bp) at (5.5,1) {}; 
          \node (2_1tree_1) at (5,2) {}; 
          \node [text = red] (2_1tree_2) at (6.2,2.3) {$n-1$}; 

          \draw[-, line width = 2pt] (2_sub_new) to (2_1tree_bp) to (2_1tree_2);
          \draw[-, line width = 2pt, oxfordblue] (2_1tree_bp.center) [bend left] to (2_1tree_1.north) [bend left] to (2_1tree_bp.center);

        %2nd subtree
          \node [bp] (2_2tree_bp) at (3.9,1) {}; 
          \node (2_2tree_1) at (3.4,2) {}; 
          \node (2_2tree_2) at (4.4,2.3) {$b$}; 

          \draw[-, line width = 2pt] (2_sub2) to (2_2tree_bp) to (2_2tree_2);
          \draw[-, line width = 2pt, oxfordblue] (2_2tree_bp.center) [bend left] to (2_2tree_1.north) [bend left] to (2_2tree_bp.center);

          % Additional subtree
          \draw[-, line width = 2pt, oxfordblue] (2_sub1.center) [bend left] to (7,1.8) [bend left] to (2_sub1.center);
        \end{scope}

        \node at (3,4) {$\tree[s]$};
        \node at (13,4) {$\tau \left(\tree[s], i, \tildei\right)$};
        \node at (6,-2.5) {$\pi \left( \tau \left( \tree[s], i, \tildei \right), \tildei \right)$};
      \end{tikzpicture}
